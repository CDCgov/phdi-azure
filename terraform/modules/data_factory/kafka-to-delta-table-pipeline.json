{
  "name": "kafka_to_delta_table",
  "properties": {
    "activities": [
      {
      "name": "kafka_to_delta_table",
      "description": "Read messages from Azure Event Hub and write to storage delta table.\n",
      "type": "WebActivity",
      "dependsOn": [],
      "policy": {
        "timeout": "0.12:00:00",
        "retry": 0,
        "retryIntervalInSeconds": 30,
        "secureOutput": false,
        "secureInput": false
      },
      "userProperties": [],
      "typeProperties": {
        "url": "${kafka_to_delta_tables_container_url}/kafka-to-delta-table",
        "method": "POST",
        "body": {
          "value": "{\n    \"kafka_provider\": \"@{pipeline().parameters.kafka_provider}\",\n \"event_hub\": \"@{pipeline().parameters.event_hub}\",\n \"event_hubs_namespace\": \"@{pipeline().parameters.event_hubs_namespace}\",\n \"connection_string_secret_name\": \"@{pipeline().parameters.connection_string_secret_name}\",\n \"storage_account\": \"@{pipeline().parameters.storage_account}\",\n \"client_secret_name\": \"@{pipeline().parameters.client_secret_name}\",\n \"client_id\": \"@{pipeline().parameters.client_id}\",\n \"tenant_id\": \"@{pipeline().parameters.tenant_id}\",\n \"container\": \"@{pipeline().parameters.container}\",\n    \"storage_provider\": \"@{pipeline().parameters.storage_provider}\",\n    \"key_vault_name\": \"@{pipeline().parameters.key_vault_name}\"\n}",
          "type": "Expression"
        },
        "authentication": {
          "resource": "api://phdi-${environment}-kafka-to-delta-table",
          "credential": {
            "referenceName": "pipeline-runner-credential",
            "type": "CredentialReference"
          },
          "type": "UserAssignedManagedIdentity"
        }
      }
    }
    ],
    "parameters": {
      "message": {
        "type": "String"
      },
      "message_type": {
        "type": "String"
      },
      "root_template": {
        "type": "String"
      },
      "filename": {
        "type": "String"
      },
      "include_error_types": {
        "type": "String"
      }
    },
    "annotations": [
      "FileName"
    ],
    "lastPublishTime": "2022-11-01T21:23:29Z"
  },
  "type": "Microsoft.DataFactory/factories/pipelines"
}
